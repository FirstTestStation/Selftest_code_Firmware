This software code is written to be loaded on selftest board 500-\/1010-\/020. The communication with the Pico controller use the I2C protocol configured as slave.

Command has received from the master controller ans the Pico selftest firmware execute the instruction and return answer to the sender

The hardware support for the firmware is on github location\+: \href{https://github.com/dlock8/Selftest_Board}{\texttt{ https\+://github.\+com/dlock8/\+Selftest\+\_\+\+Board}}\hypertarget{md_README_autotoc_md1}{}\doxysection{License}\label{md_README_autotoc_md1}
This project is licensed under the BSD 3-\/Clause License. See the \href{./LICENSE}{\texttt{ LICENSE}} file for more details.\hypertarget{md_README_autotoc_md2}{}\doxysection{Project setup}\label{md_README_autotoc_md2}
This project has been developped on raspberry pi 4 following installation instruction from this pdf \href{./documentation/getting-started-with-pico_C.pdf}{\texttt{ getting-\/started-\/with-\/pico\+\_\+\+C.\+pdf}}, a copy of the pdf is located on the main folder.

Visual studio has been used for development and raspberry pi 4 for Pico debug. ~\newline


Based on \href{https://github.com/vmilea/pico_i2c_slave}{\texttt{ https\+://github.\+com/vmilea/pico\+\_\+i2c\+\_\+slave}}. The pico\+\_\+i2c\+\_\+slave software has been added to enable the Raspberry Pi Pico to function as an I2C device.

The compilation is performed using Visual Studio and the important extension installed are\+:


\begin{DoxyItemize}
\item Cmake v0.\+0.\+17
\item Cmake Tools v1.\+20.\+10
\item Cortex-\/\+Debug v1.\+12.\+1
\item debug-\/tracker-\/vscode v0.\+0.\+15
\item Doxygen Documentation Generator v1.\+4.\+0
\item Doxygen runner v1.\+8.\+0
\item Github Pull Request v0.\+96.\+0
\item Hex Editor v1.\+10.\+0
\item Memory\+View v0.\+0.\+25
\item peripheral Viewer v1.\+4.\+6
\item RTOS view v0.\+0.\+7
\item C/\+C++ v1.\+21.\+6
\end{DoxyItemize}

I not sure if all extensions are required but is the one installed presently.\hypertarget{md_README_autotoc_md3}{}\doxysection{Building}\label{md_README_autotoc_md3}
Build of this cmake project is performed with Visual Studio\hypertarget{md_README_autotoc_md4}{}\doxysection{Development}\label{md_README_autotoc_md4}

\begin{DoxyItemize}
\item \href{IO_selftest/selftest.c}{\texttt{ {\ttfamily selftest.\+c}}} is the main source file for the firmware.
\item \href{CMakeLists.txt}{\texttt{ {\ttfamily CMake\+Lists.\+txt}}} contains build instructions for CMake.
\item \href{pico_sdk_import.cmake}{\texttt{ {\ttfamily pico\+\_\+sdk\+\_\+import.\+cmake}}} was (as usual) copied verbatim from the Pico SDK and allows CMake to interact with the SDKâ€™s functionality.
\end{DoxyItemize}\hypertarget{md_README_autotoc_md5}{}\doxysection{Installation}\label{md_README_autotoc_md5}

\begin{DoxyItemize}
\item The Files \href{build/IO_selftest/selftest.uf2}{\texttt{ \textquotesingle{}selftest.\+uf2\textquotesingle{}}} contains the firmware to be loaded on the Pico RP2040 board using USB cable and boot button.
\item When software loaded, the Pico board should be installed on the location marked ST\+\_\+\+CTRL on Selftest Board.
\item On board Pico Led will flash slowly (heartbeat) on power ON.
\end{DoxyItemize}\hypertarget{md_README_autotoc_md6}{}\doxysubsection{Setup}\label{md_README_autotoc_md6}
Follow the instructions in \href{https://datasheets.raspberrypi.org/pico/getting-started-with-pico.pdf}{\texttt{ Getting started with Raspberry Pi Pico}} to setup your build environment.\hypertarget{md_README_autotoc_md7}{}\doxysection{I2\+C Command supported}\label{md_README_autotoc_md7}
Pico i2C Selftest Protocol

I2C Command is 2 bytes long\+: Command\+\_\+byte (1 byte) + Data (1 byte)

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{3}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Command\+\_\+\+Byte   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Function   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description    }\\\cline{1-3}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Command\+\_\+\+Byte   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Function   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description    }\\\cline{1-3}
\endhead
00   &Reserved   &used for special purpose    \\\cline{1-3}
01   &Get Major Version   &return major version of firmware    \\\cline{1-3}
02   &Get Minor Version   &return minor version of firmware    \\\cline{1-3}
10   &Clear GPx   &Write 0 on GPx    \\\cline{1-3}
11   &Set GPx   &Write 1 on GPx    \\\cline{1-3}
15   &Read GPx   &Read GPx state    \\\cline{1-3}
20   &Set Dir GPx Out   &Set direction Out for Gpx    \\\cline{1-3}
21   &Set Dir GPx In   &Set direction In for Gpx    \\\cline{1-3}
25   &Get Dir GPx   &Read GPX direction, 0 = In , 1 = Out    \\\cline{1-3}
30   &Set GPx strength = 2mA   &Set GPx output max current    \\\cline{1-3}
31   &Set GPx strength = 4mA   &Set GPx output max current    \\\cline{1-3}
32   &Set GPx strength = 8mA   &Set GPx output max current    \\\cline{1-3}
33   &Set GPx strength = 12mA   &Set GPx output max current    \\\cline{1-3}
35   &Get Gpx drive strength   &Read strength\+: 0\+: 2mA, 1\+: 4mA, 2\+: 8mA, 3\+: 12mA    \\\cline{1-3}
41   &Set pull\+\_\+up GPx   &Add pull-\/up to Gpx    \\\cline{1-3}
45   &Get pull-\/up GPx   &Read pull-\/up state (1\+: pull-\/up active)    \\\cline{1-3}
50   &Disable pulls   &Remove pull-\/up and pull-\/down    \\\cline{1-3}
51   &Set pull\+\_\+down GPx   &Add pull-\/down to Gpx    \\\cline{1-3}
55   &Get pull-\/down GPx   &Read pull-\/down state (1\+: pull-\/down active)    \\\cline{1-3}
60   &Set Pads State value   &Set Pads State register for use later    \\\cline{1-3}
61   &Set GPx to Pads State   &Write contains of command 60 on GPx    \\\cline{1-3}
65   &Get Pads state Gpx   &Read PAD register for Gpx    \\\cline{1-3}
75   &Get GPIO function   &Read gpio function associated to gpio number    \\\cline{1-3}
&&XIP = 0, SPI=1, UART=2, I2C =3, PWM=4, SIO = 5    \\\cline{1-3}
&&PIO0 =6, PIO1=7, GPCK=8, USB=9, NULL = 0x1f    \\\cline{1-3}
80   &Set PWM State   &1\+: Enable 0\+: Disable    \\\cline{1-3}
81   &Set PWM Frequency   &Freq in Khz 0=100Hz, 1= 1Khz, 255 = 255KHz (8 bits)    \\\cline{1-3}
&&\\\cline{1-3}
100   &Device Status   &Bit Status (8 bits)    \\\cline{1-3}
&Bit 0   &Config Completed 0\+: true    \\\cline{1-3}
&Bit 1   &Command accepted 0\+: true    \\\cline{1-3}
&Bit 2   &Error 1= true    \\\cline{1-3}
&Bit 3   &watchdog trigged 1= true    \\\cline{1-3}
101   &Enable UART   &setup UART mode 0\+: TX/\+RX, 1\+: TX/\+RX + CTS/\+RTS    \\\cline{1-3}
102   &Disable UART   &setup UART to SIO mode\+: 0\+:input gpio, 1\+:output gpio    \\\cline{1-3}
103   &Set UART protocol   &set UART protocol, see bits definition below    \\\cline{1-3}
105   &Get UART config   &return 1 byte config protocol\+:    \\\cline{1-3}
&&Bit 7-\/6 Baudrate 0\+:19200, 1\+:38400,2\+: 57600, 3\+:115200    \\\cline{1-3}
&&Bit 5-\/4 parity 0\+: None, 1\+: Even, 2\+: Odd    \\\cline{1-3}
&&Bit 3\+:2 data bits 0\+:5, 1\+:6, 2\+:7,3\+:8    \\\cline{1-3}
&&Bit 1 stop bits 0\+:1 stop , 1\+:2 stops    \\\cline{1-3}
&&Bit 0 handshake RTS/\+CTS 0\+: None, 1\+: Used    \\\cline{1-3}
&&\\\cline{1-3}
111   &Enable SPI   &0\+: Enable, 1\+:Enable, Default configuration    \\\cline{1-3}
112   &Disable SPI   &Setup SPI to SIO mode\+: 0\+:input gpio, 1\+:output gpio    \\\cline{1-3}
113   &Set SPI protocol   &set SPI protocol, see bits definition below    \\\cline{1-3}
115   &Get SPI config   &return 1 byte config protocol\+:    \\\cline{1-3}
&&Bit 7\+:4 Baudrate Value $\ast$ 100Khz    \\\cline{1-3}
&&Bit 3 Databits 0\+:8, 1\+:16    \\\cline{1-3}
&&Bit 2\+:1 Mode Clock Polarity, Clock Phase    \\\cline{1-3}
&&\+\_\+\+\_\+\+\_\+ Mode 0\+: Cpol\+:0 , Cpha 0    \\\cline{1-3}
&&\+\_\+\+\_\+\+\_\+ Mode 1\+: Cpol\+:0 , Cpha 1    \\\cline{1-3}
&&\+\_\+\+\_\+\+\_\+ Mode 2\+: Cpol\+:1 , Cpha 0    \\\cline{1-3}
&&\+\_\+\+\_\+\+\_\+ Mode 3\+: Cpol\+:1 , Cpha 1    \\\cline{1-3}
&&Bit 0 SPI Status, 0\+:disable, 1\+:enable Read only   \\\cline{1-3}
\end{longtabu}
